# from transformers import T5Tokenizer, T5ForConditionalGeneration, AutoTokenizer

# # tokenizer = T5Tokenizer.from_pretrained("t5-small")
# # model = T5ForConditionalGeneration.from_pretrained("t5-small")

# # input_ids = tokenizer("Create other options for this question-answer pair: How come Ireland is part of Great Britain?Ireland is not part of Great Britain - it's independent", return_tensors="pt").input_ids
# # outputs = model.generate(input_ids)
# # print(tokenizer.decode(outputs[0], skip_special_tokens=True))

# tokenizer = AutoTokenizer.from_pretrained("t5-small")
# model = T5ForConditionalGeneration.from_pretrained("t5-small")
# input_ids = tokenizer.encode('summarize: I enjoy walking with my cute dog', return_tensors='pt')
# greedy_output = model.generate(input_ids, num_beams=7, no_repeat_ngram_size=2, min_length=50, max_length=100)
# print("Output:\n" + 100 * '-')

# print(tokenizer.decode(greedy_output[0], skip_special_tokens=True))

# metrics={'test_loss': 1.5173571109771729, 'test_scores': [-0.8373126983642578, -0.26524391770362854, 0.17755648493766785, -0.06480900943279266, -0.16841444373130798, -1.370699167251587, -0.35337236523628235, 0.5695403814315796, -1.0314074754714966, 0.7108270525932312, 0.5031419992446899, 0.6573505997657776, 0.7363375425338745, 0.517350971698761, -1.5903412103652954, -0.9195288419723511, -0.39934176206588745, -0.7449410557746887, -0.6913345456123352, -0.6019724011421204, 0.30797579884529114, 0.38494113087654114, 0.31109827756881714, 0.1713482141494751, -1.9340821504592896, 0.38132280111312866, -0.46380913257598877, -0.5955982804298401, 0.1370970904827118, 0.13048550486564636, 0.16371706128120422, -0.7410697340965271, -0.5898131132125854, -0.9650912880897522, -0.27771615982055664, -0.4581963121891022, -0.33721238374710083, -0.11462703347206116, -0.5477761030197144, -0.1764945685863495, -0.22141826152801514, 1.0260353088378906, 0.47739964723587036, -1.2525947093963623, -1.7420800924301147, 0.3714509606361389, -0.3656861484050751, -1.3481473922729492, -1.4125192165374756, -0.4030766487121582, -1.4023863077163696, -1.4663150310516357, -1.2787625789642334, -0.34954822063446045, 1.0304564237594604, 0.32620033621788025, -0.5597358345985413, -0.005588982254266739, 0.5734291672706604, 0.7081968188285828, -0.006943050771951675, 0.5061954259872437, 0.8830190896987915, -0.02932845428586006, -0.34669920802116394, -0.8663815855979919, -1.616868257522583, -1.5950775146484375, -1.3947274684906006, -0.46827390789985657, -0.2317313551902771, -0.5401903986930847, -1.0956177711486816, -1.045057773590088, -1.1050273180007935, -1.6144413948059082, -0.4455222487449646, -0.5052247643470764, -0.08030553162097931, 0.4992680549621582, -0.4879459738731384, 0.09750966727733612, -1.1461328268051147, -0.7300878167152405, -0.9681819081306458, -0.7312828302383423, -1.0888495445251465, -0.7426111698150635, -0.990390419960022, -0.5902039408683777, -0.9605138897895813, 1.0120114088058472, 0.7115252614021301, -0.30460304021835327, 0.5139927864074707, -0.89332515001297, -1.248791217803955, -1.3300206661224365, -1.550360918045044, 0.6086688041687012, 0.4539684057235718, 0.5903810858726501, -0.21894407272338867, 0.5922139286994934, 0.5383409261703491, 1.0467110872268677, 0.46639665961265564, 0.5044989585876465, -0.05563761666417122, 0.3565385341644287, 1.0259315967559814, -0.14719422161579132, 0.11672767996788025, 0.32086461782455444, -0.2020556479692459, -0.5401590466499329, -0.7328043580055237, -0.6137821078300476, -0.6024144291877747, -0.589729368686676, -0.6419112086296082, -0.9249245524406433, -0.9677428007125854, 0.33263444900512695, -1.2074345350265503, -1.5460383892059326, -1.1893327236175537, -0.519420325756073, -0.21163734793663025, -0.1674860566854477, -0.636729896068573, -0.15849265456199646, -1.1598162651062012, -1.0090620517730713, 0.664775550365448, -0.024989549070596695, -0.19683517515659332, 0.2768990695476532, -0.3684424161911011, -0.10873275995254517, 0.9132416844367981, 0.45330575108528137, 0.048392023891210556, -0.13711267709732056, -0.8560004830360413, -0.4680028259754181, -0.6941574811935425, -0.6099079251289368, -0.3868555426597595, -0.7709028720855713, -0.8201431035995483, -0.6988239884376526, -1.0807833671569824, -1.0334298610687256, -1.1027262210845947, -0.9860466122627258, -0.8003761768341064, -0.559955358505249, -1.0325298309326172, -1.2306089401245117, -1.3362035751342773, -1.3263227939605713, 0.11391454935073853, 0.20478707551956177, 0.00870354101061821, 1.0909146070480347, 0.16214072704315186, 0.6903123259544373, -0.3344147801399231, 0.47904396057128906, 0.4427418112754822, -0.4315592348575592, -0.07823827862739563, -0.48400789499282837, 0.5422168374061584, 0.03569791838526726, -0.22981925308704376, -1.7909252643585205, -0.45562803745269775, -1.1702138185501099, -0.49584025144577026, -0.7327403426170349, -1.2831584215164185, -1.4435219764709473, -1.4197115898132324, -1.487425446510315, -0.20430415868759155, -0.47044238448143005, -0.13447222113609314, -0.39125147461891174, -0.6538510918617249, -1.2415114641189575, -0.3561299443244934, -1.3459606170654297, -1.2756156921386719, 1.064595103263855, 0.47141388058662415, 0.2543662488460541, -1.6763876676559448, 0.0644087940454483, -1.378937005996704, 0.10365709662437439, -1.353318452835083, -0.11519433557987213, -0.1829080581665039, 0.08158117532730103, 0.31101009249687195, 0.073097363114357, -0.03899819776415825, -0.3634933829307556, -0.579560399055481, 0.4546259641647339, -0.009889725595712662, -0.20767243206501007, -1.3750159740447998, -1.285033106803894, -1.1901202201843262, -0.03468671813607216, -0.09616318345069885, -0.2391364872455597, -1.1606800556182861, -1.2364636659622192, -0.3307207226753235, -0.7296806573867798, 0.17995518445968628, -1.3459175825119019, -1.44242262840271, -1.3971980810165405, -1.457013487815857, -1.446198582649231, -0.00444449856877327, 0.3882454037666321, 1.0170494318008423, -0.3178240954875946, 0.392319917678833, 0.8122085928916931, -0.35789862275123596, 0.11473685503005981, -0.3876267373561859, -0.4265219569206238, -1.5348803997039795, -1.5419204235076904, -1.619933009147644, -1.4996997117996216, 0.37520915269851685, -0.3411020040512085, 0.33725705742836, 0.4298306703567505, 0.071769118309021, -0.22475069761276245, -0.19959419965744019, -0.3590967655181885, -0.8123272061347961, -0.8687561750411987, -0.601721465587616, -0.6121934056282043, -1.2618913650512695, -1.374241590499878, -0.5494213104248047, -0.5656949877738953, 0.2779332399368286, -0.7232776284217834, -0.7330214381217957, -0.7959092259407043, 0.12027217447757721, -0.09013046324253082, -0.47135722637176514, 0.34313270449638367, 0.19176994264125824, 0.19656944274902344, -1.5978760719299316, -1.1038918495178223, -0.9112088084220886, -0.5845220685005188, -1.4502931833267212, -1.4763081073760986, -1.3118387460708618, -1.5247628688812256, -1.165307879447937, -0.2045365571975708, -0.7875528931617737, 0.1703529953956604, 1.0123622417449951, -0.42281123995780945, -0.29885444045066833, -0.4248088002204895, 1.0375615358352661, 0.33125171065330505, -0.4573582410812378, -1.326533317565918, -1.1347856521606445, -1.0199414491653442, 0.21276670694351196, 0.14699873328208923, -0.045901764184236526, 0.9746977090835571, -0.4771595001220703, -0.7303882837295532, -0.4873589277267456, -0.49908918142318726, 1.0885822772979736, -0.07476416230201721, 0.6115140318870544, -0.23282092809677124, -0.028358493000268936, 1.0720323324203491, 0.44757115840911865, 0.4631960988044739, 0.1824711561203003, 0.4221936762332916, -0.1150086522102356, -0.7515205144882202, -1.0199612379074097, -0.5300145745277405, 0.34516024589538574, 0.40581998229026794, 0.3651522397994995, -0.22656182944774628, -0.659673273563385, -1.6220061779022217, -1.7574191093444824, -0.4570327401161194, -1.455356478691101, -1.5544780492782593, -1.5047645568847656, -0.5489770174026489, 0.45651257038116455, -0.12413990497589111, 0.4936986565589905, 0.33021897077560425, 0.05966443940997124, 0.4956669807434082, 0.5230926871299744, 0.4447411000728607, 0.41097018122673035, 0.40580132603645325, -1.1678993701934814, 0.7962661385536194, -1.3818241357803345, -1.4436004161834717, -1.4690006971359253, -0.0880860984325409, 0.14939618110656738, 0.08560410141944885, 0.7524147033691406, 0.03193190321326256, -0.018258679658174515, 0.7621017098426819, -0.027660254389047623, -1.0775989294052124, -0.9983555674552917, -1.0094270706176758, -1.0517005920410156, -0.36945462226867676, -0.3125230669975281, -0.303546279668808, -0.23073232173919678, 0.45282506942749023, -0.21234819293022156, -0.295750230550766, -0.20076856017112732, -0.054926592856645584, -1.594107747077942, -1.0024774074554443, -1.6836026906967163, -1.7794904708862305, -1.8175232410430908, 0.9909554123878479, 0.2639644145965576, 0.37007659673690796, -0.37170884013175964, -0.3941490054130554, -0.06913535296916962, 0.693504273891449, 0.37474846839904785, 0.32464879751205444, 0.3895915746688843, 0.5570491552352905, 0.3222391605377197, 0.34517619013786316, 0.007677953690290451, -0.765660285949707, -0.4316801130771637, -0.8668114542961121, -0.9353157877922058, 0.19336169958114624, -0.11153188347816467, 0.022683393210172653, -0.24572744965553284, 0.23757553100585938, -0.12595234811306, 0.12359146773815155, 0.19652479887008667, 0.1570732742547989, -0.07581421732902527, 0.18881654739379883, -0.7685390114784241, -0.7671963572502136, -0.16301438212394714, -0.14463652670383453, -0.6492290496826172, -0.553029477596283, -0.6669557094573975, 0.6059825420379639, -0.24741393327713013, -0.43160495162010193, -0.22893273830413818, -0.07886803150177002, -0.5575925707817078, -0.5990940928459167, -0.4318564534187317, -1.0268274545669556, -1.0987000465393066, -1.1556230783462524, -0.8134623765945435, -0.5048832297325134, -0.38861796259880066, -0.5137842893600464, -0.33381277322769165, -0.28520339727401733, -0.427435964345932, 0.9625470042228699, -0.4682666063308716, -0.7098352313041687, -0.4571533203125, -1.2868157625198364, -1.1417781114578247, -0.9049074649810791, -1.46376371383667, -0.9949367642402649, 0.3115902841091156, -0.11729845404624939, -0.13643532991409302, 0.5429604649543762, -0.3309580385684967, -0.9063320755958557, -1.0969383716583252, -1.345750093460083, -1.1423611640930176, -0.9387098550796509, -1.3482203483581543, -1.232986569404602, 0.08999256789684296, 0.42081117630004883, -0.5796447396278381, -0.15674357116222382, -0.0008321143686771393, 0.9903227686882019, -0.0904121994972229, 0.23766639828681946, -0.2578009366989136, -1.1891274452209473, -1.64194655418396, -1.8038212060928345, -1.7539985179901123, -1.6374495029449463, 0.9008325338363647, 0.38644132018089294, -0.1474020779132843, 0.3521115779876709, -1.0833213329315186, -1.0922608375549316, -1.083784818649292, -0.656498372554779, -0.688551127910614, -0.830008327960968, -0.6898669004440308, 1.0677331686019897, 0.4095131456851959, -0.6457870006561279, -0.20292967557907104, 1.1325852870941162, -0.05500685051083565, -1.0664347410202026, -0.5809110999107361, -0.39822056889533997, -1.358565092086792, -0.12309569120407104, -0.04328915849328041, -1.3520216941833496, -1.1136703491210938, -0.7630771398544312, -1.0867278575897217, -1.0139517784118652, -1.2201297283172607, -1.5067708492279053, -1.511448860168457, -0.9218901991844177, -1.185243844985962, -0.698067843914032, -0.7199711203575134, -0.9551326036453247, -0.4220331013202667, -0.7293623089790344, -0.4376252293586731, -0.4805367887020111, -0.26221585273742676, -0.1429402381181717, -0.6176450848579407, 0.054391469806432724, -0.8588866591453552, 0.07921087741851807, 0.17210589349269867, -0.9756001830101013, -0.8253577947616577, 0.354282021522522, -0.916796088218689, 0.3246149718761444, -0.6130315661430359, -1.0086486339569092, -1.39095139503479, -0.81620192527771, 0.3020184636116028, -0.22646337747573853, 0.04576006159186363, -0.033029381185770035, 0.19505134224891663, 0.13822467625141144, -0.09006059169769287, -0.062022749334573746, -0.4669174551963806, -0.9974731206893921, -0.8378395438194275, -1.2072898149490356, 0.8952211141586304, -0.5431557297706604, -0.1291736364364624, -0.3071492910385132, 0.973121166229248, 0.7296004295349121, -0.13966670632362366, 0.5477921962738037, -1.3493950366973877, -1.4500336647033691, -1.4560866355895996, -1.5523200035095215, -1.5457937717437744, -1.3067371845245361, -1.1776866912841797, -0.30423787236213684, -1.7578213214874268, -0.4383787512779236, -1.7913379669189453, -0.08440512418746948, -0.5979363918304443, -0.07232624292373657, -0.2636728882789612, -0.3363727629184723, -0.7935935258865356, -0.7825118899345398, -0.46676915884017944, -0.2927812337875366, -0.27330106496810913, -0.37669897079467773, -1.157987356185913, -0.9972093105316162, -0.7265575528144836, -1.6976693868637085, -0.8622753024101257, -0.3513633608818054, -1.1740176677703857, -1.3117834329605103, -0.4446105360984802, -1.2992479801177979, -1.4118192195892334, -1.1848125457763672, -0.4167112410068512, -1.0733916759490967, 1.0310211181640625, -0.6233121752738953, 0.7221879363059998, 0.02563544735312462, -0.06251850724220276, 0.7329910397529602, 0.6579813957214355, 0.6415570378303528, -0.6887134909629822, -1.0357803106307983, -1.0556461811065674, 0.1867680847644806, 0.1728563755750656, -0.013662490993738174, -0.3235864043235779, -0.24905066192150116, 0.5599043965339661, 0.6550309062004089, 0.5307971239089966, -0.23991385102272034, -0.3822671175003052, -0.7597993016242981, -1.729149580001831, -1.8108782768249512, -1.4825031757354736, 0.297200083732605, -0.009024519473314285, -0.9363774061203003, -0.8999600410461426, 0.7323440909385681, -0.002950463443994522, 0.03784449025988579, 0.041896577924489975, -0.3109695017337799, -0.3006138801574707, 0.3321857452392578, -1.335828185081482, -0.06554584205150604, 0.04521539434790611, 0.12705011665821075, 0.14913851022720337, -0.0008955635130405426, -0.6148621439933777, -0.3492072820663452, -0.42464959621429443, 0.046358849853277206, -0.40038010478019714, 0.05920633301138878, -0.014996815472841263, 0.5804852247238159, -1.019654631614685, 0.007310252636671066, -1.449283242225647, -0.9452576041221619, -1.2310154438018799, -1.0666979551315308, -0.6598120927810669, -0.6823510527610779, -0.5520870089530945, -0.7998364567756653, -0.7883417010307312, -0.7995665669441223, -1.4622268676757812, -1.5464770793914795, -1.778896450996399, -1.6223582029342651, -0.5989778637886047, -0.7609208822250366, -1.3440642356872559, -0.7869728207588196, -0.611529529094696, -0.7197100520133972, 0.308916836977005, 0.0421576090157032, -0.4185594916343689, -0.7055005431175232, -0.980810821056366, -0.8341693878173828, -0.8873618841171265, -1.2089567184448242, -0.7328656315803528, -0.9258859753608704, -0.931995689868927, -0.7674562931060791, -0.10597653687000275, 0.2786570191383362, 0.009459007531404495], 'test_runtime': 147.3832, 'test_samples_per_second': 4.444, 'test_steps_per_second': 1.113}

# metrics_2 = {'eval_loss': 1.4691622257232666, 'eval_scores': [-0.5250239968299866, -0.5169983506202698, -1.1489927768707275, -0.4716310203075409, -0.4985322058200836, -1.2201281785964966, 0.9717923998832703, -0.2786135971546173, 1.0408146381378174, -0.7360941171646118, 0.1554708182811737, 0.23196804523468018, 0.19228705763816833, -0.15920045971870422, -0.20922282338142395, 1.0159485340118408, -0.5328736901283264, -0.05356496945023537, -0.5482704043388367, -0.7064709067344666, -0.4534272849559784, -0.1836058795452118, -0.06146617606282234, -0.20499654114246368, -0.27746647596359253, -0.19679990410804749, -0.5428235530853271, -0.17758607864379883, -0.23871606588363647, -0.5701302886009216, -0.4789426922798157, 0.7849070429801941, -0.06661048531532288, -1.0572729110717773, -1.2402039766311646, -0.06469134986400604, 0.0964844673871994, -2.261166572570801, -1.1605889797210693, -1.2605749368667603, -1.311206340789795, -0.9407407641410828, -1.1936867237091064, -1.3306610584259033, -0.27220070362091064, -0.015432272106409073, 0.15949593484401703, 0.19312049448490143, -0.07540193200111389, -1.4327611923217773, -0.2862541079521179, -1.5018768310546875, -0.14625726640224457, -1.4412217140197754, -1.5657548904418945, 0.22166487574577332, 0.04322589561343193, 0.2811912000179291, -0.6965602040290833, -0.5147209167480469, -0.4519590139389038, -0.32212314009666443, 0.25755575299263, 0.04398992285132408, -0.7039157152175903, -0.48571163415908813, -0.6943489909172058, -0.07179108262062073, 0.013236772269010544, -0.30434396862983704, -0.6487162113189697, -0.4530985653400421, -0.2994098961353302, -0.16962936520576477, -1.3222901821136475, -0.6789427399635315, -1.00394606590271, -1.0061495304107666, -1.0081787109375, 0.8317544460296631, -1.536454439163208, 0.1940975785255432, -0.009966079145669937, -0.9631676077842712, 0.20371203124523163, 1.0084035396575928, 0.2859443724155426, 0.3777141571044922, -0.11039260029792786, 0.22787439823150635, 0.07320135831832886, -0.7893681526184082, -0.8837689757347107, -0.708591878414154, -0.5207880735397339, -0.4038478434085846, -1.537794828414917, -1.4779659509658813, -1.2477607727050781, -1.1039297580718994, -1.2768654823303223, -0.42329859733581543, -2.1339800357818604, -0.27551785111427307, 0.20962347090244293, -1.156838059425354, 0.10871744155883789, -1.1163017749786377, -0.28889647126197815, 0.15677854418754578, -1.8085408210754395, -1.5215892791748047, -1.3614822626113892, -0.7827914357185364, -1.2624260187149048, -1.5297831296920776, -1.381441354751587, 0.007905703037977219, -0.06333599984645844, -0.3981216549873352, -0.07437214255332947, 0.1231246292591095, 0.10390651226043701, -0.03324239328503609, 0.03166132792830467, -1.4137141704559326, 0.047827523201704025, 0.044467683881521225, 0.12977416813373566, 0.20847097039222717, -0.18943363428115845, 0.15482936799526215, 0.12371447682380676, -0.35556232929229736, -0.6941657066345215, -0.4589776396751404, -0.8423041701316833, 0.25210896134376526, 0.4482021927833557, 0.4144672453403473, 0.653045117855072, 0.28039175271987915, -0.47081491351127625, -0.17357195913791656, 0.35905805230140686, -0.20532575249671936, -0.21585224568843842, -0.35850241780281067, -0.25764691829681396, -0.32127267122268677, -0.07848066091537476, -0.5006416440010071, -0.15197843313217163, -0.07778434455394745, 0.021560188382864, -0.11080044507980347, -0.17901962995529175, -0.08505259454250336, -0.17416533827781677, -0.4023773968219757, -0.1372421830892563, 0.2863534986972809, -0.10740014910697937, 0.17221654951572418, -0.1272846758365631, -0.21019130945205688, -0.4130895435810089, -0.48408520221710205, -0.17616555094718933, -0.6928112506866455, -0.6779529452323914, -0.20783521234989166, -0.38358274102211, -1.0550731420516968, -0.9210925698280334, -0.718777596950531, -0.8015102744102478, -0.7595056295394897, -0.8302770256996155, -0.9187929034233093, -0.8583688139915466, 0.5581384301185608, -0.3282336890697479, -0.026181522756814957, -0.054185349494218826, -0.7422468066215515, -0.2948295772075653, -0.5025345683097839, -0.6834540963172913, -0.5810868144035339, -0.13605928421020508, -0.4357590675354004, 0.32626432180404663, 0.136918306350708, 0.021890681236982346, -0.24017322063446045, 0.10790039598941803, -0.6395674347877502, -0.38622552156448364, -0.45189008116722107, -0.4387151896953583, -0.4036429822444916, -0.4379752278327942, 1.0405722856521606, 0.41545388102531433, -1.119117021560669, -0.6202419400215149, -2.124825954437256, -0.8472163081169128, -0.5745087265968323, -1.3708558082580566, -1.2091095447540283, -1.2877304553985596, -1.3477668762207031, -1.599083662033081, -1.230234980583191, 0.668103039264679, -0.2057909369468689, 0.05148620530962944, -0.16701120138168335, -0.3521607220172882, -0.01709163561463356, -1.4410501718521118, -1.3827823400497437, -1.3894150257110596, -1.4499748945236206, -1.1924772262573242, 0.7463404536247253, 0.708215594291687, 0.6910222768783569, -0.6211734414100647, 0.3690926432609558, -0.32353436946868896, 0.573936939239502, 0.19916538894176483, -0.06333310902118683, -0.16915827989578247, -0.09879887104034424, -0.34304723143577576, -0.3837655782699585, -0.1497325897216797, -0.11464336514472961, -0.4214955270290375, 0.639744222164154, -0.03629136458039284, 0.5986237525939941, -0.07852038741111755, 0.5917146801948547, 0.4162447154521942, -0.3586413860321045, -0.5494046807289124, 0.1724061220884323, -0.16275909543037415, -0.217678964138031, -0.3234853744506836, -0.22106561064720154, -0.13925416767597198, -0.588179886341095, -0.962052047252655, -0.9664342999458313, -0.9871137738227844, -1.6208932399749756, -1.4716931581497192, -1.3343291282653809, -1.330552577972412, -1.4601638317108154, 0.11078649759292603, -0.07464706897735596, 0.010929923504590988, -1.3671998977661133, -0.25963976979255676, -0.7635485529899597, -0.8055254817008972, -0.9062409996986389, -0.5840420126914978, -0.9745296835899353, -0.5998027324676514, 0.10589510202407837, 0.0023141615092754364, 0.018107231706380844, -0.2926493287086487, -0.8014984726905823, -0.20711633563041687, 0.9320526123046875, -0.9138882160186768, -0.7987883687019348, -0.29497405886650085, 0.011488143354654312, 0.6953827738761902, -0.01883862540125847, 0.6961176991462708, 1.0482020378112793, 0.1215469092130661, 0.4028870463371277, -0.8450265526771545, -0.3625299036502838, -0.37553122639656067, -1.1131298542022705, -1.3007841110229492, -1.381071925163269, -0.15903262794017792, -0.5476905107498169, -0.6586750149726868, -0.7046253681182861, -0.03141038492321968, -0.4434526264667511, -0.0826205164194107, -0.6174769997596741, -0.9088934659957886, 0.41159868240356445, -1.9957716464996338, -1.9718480110168457, -1.588259220123291, -1.9277877807617188, -2.0236833095550537, -1.8871906995773315, 0.35123926401138306, 0.08634261786937714, -0.8506280183792114, -0.3897011876106262, -0.2700539529323578, -0.3118842542171478, 0.5314821600914001, 1.0476123094558716, -0.3154136836528778, 0.4524972140789032, -1.0724878311157227, -1.1095960140228271, -1.595606803894043, 1.0059144496917725, -0.4156511723995209, -0.7897778749465942, -0.8880590796470642, -1.6189664602279663, -1.3307974338531494, -1.4159588813781738, -1.4708093404769897, -1.3441472053527832, -0.13326865434646606, -0.09180891513824463, -0.2006576806306839, -0.6806272268295288, -0.3342286944389343, -0.5821718573570251, -0.5833765268325806, -0.48034271597862244, -0.5261020064353943, -0.8119550347328186, -0.12151630222797394, -0.7530821561813354, -0.6659590601921082, -0.41695499420166016, -0.2876987159252167, -0.7405261397361755, 0.015877332538366318, -0.8720700740814209, -0.5113752484321594, 0.38414400815963745, 0.6801177263259888, 0.5091426968574524, 0.15648645162582397, -0.05061621591448784, -0.17726454138755798, -0.7577648758888245, -1.0942165851593018, -1.3338264226913452, 1.073667049407959, -0.18298578262329102, 0.019574414938688278, 0.9698078036308289, -0.36765265464782715, -0.49908918142318726, 1.0885822772979736, -0.07476416230201721, 0.7440276741981506, 0.30366772413253784, 0.32917243242263794, -1.5709894895553589, -0.4780851900577545, 0.07700121402740479, 0.5806825160980225, -1.1353998184204102, 0.01028890535235405, 0.14313524961471558, -0.21248453855514526, -0.4762609601020813, -1.6343722343444824, -1.5131664276123047, 0.03664824739098549, -0.41962775588035583, -0.41902169585227966, -0.22840268909931183, 0.7172685265541077, 0.4924793839454651, 0.16257941722869873, -0.574694812297821, -0.6171585917472839, -0.47499218583106995, -0.7410945892333984, -1.0570487976074219, -0.6734520196914673, 0.7157763838768005, 0.24226421117782593, 0.2297496795654297, 0.7443462014198303, -0.20108208060264587, -0.45984697341918945, -0.19419512152671814, -0.7513049244880676, -0.5062548518180847, -0.10660110414028168, -0.4291823208332062, -0.23377075791358948, -0.9677606225013733, -1.2031090259552002, -1.4246224164962769, -1.2366552352905273, -1.2017490863800049, -1.1076655387878418, -1.1628899574279785, -1.1070282459259033, -1.1330254077911377, -1.048697829246521, 0.22927334904670715, 0.31326302886009216, 0.13133813440799713, 0.20847097039222717, -0.1736142486333847, 0.08732457458972931, 0.08871126174926758, -0.382877379655838, 0.27128738164901733, 0.13644137978553772, -0.5813668370246887, -0.008189264684915543, 0.26855379343032837, -1.320507526397705, -1.4336895942687988, 0.5007463693618774, -1.4786062240600586, -1.2164387702941895, -1.1248817443847656, -0.6432917714118958, 0.7620237469673157, -0.021848831325769424, -0.42705750465393066, -0.28228482604026794, -0.4880870580673218, 1.0550024509429932, -1.2006371021270752, -0.767717719078064, -1.3813570737838745, -0.8681592345237732, -0.9066952466964722, -0.7144513726234436, -1.4334442615509033, -0.8335080146789551, 0.0672449916601181, -1.0385487079620361, -0.8048040270805359, 1.0133099555969238, -0.8742661476135254, -0.46535205841064453, -0.5898643732070923, -0.5391823649406433, -0.5976167321205139, -0.8654434084892273, -0.621278703212738, -0.8708617091178894, -0.6849318146705627, -1.2102335691452026, -0.864551842212677, 1.006723165512085, 0.49616050720214844, 0.46195125579833984, 0.5155415534973145, -1.481885313987732, -0.41595959663391113, -0.11261121928691864, -0.006429988890886307, -0.1793200671672821, -0.25931569933891296, 0.3356369137763977, 0.014497023075819016, 0.2972867488861084, -1.2919820547103882, -0.12743547558784485, -0.12580563127994537, -0.3071956932544708, 0.3049314320087433, -0.09915582835674286, 0.3212035894393921, -1.3641003370285034, -0.4876251518726349, 0.7291305661201477, -2.022150993347168, 0.12118302285671234, -0.5281577110290527, -1.661637783050537, -1.1617283821105957, 0.8086308836936951, -0.36256009340286255, -0.29436564445495605, 1.0117855072021484, 0.7788516879081726, 0.4806024432182312, 0.6244487762451172, -1.6678305864334106, -1.426498293876648, -1.3208624124526978, -1.13419508934021, -1.3640763759613037, -1.3669100999832153, -1.4471499919891357, -0.5379343628883362, -0.39640137553215027, -0.49464353919029236, -0.47204890847206116, -0.17623412609100342, -0.18152403831481934, -0.02581072226166725, -0.3540043532848358, 0.8568574786186218, 0.19901075959205627, 0.6231756210327148, 0.22525079548358917, 0.11862337589263916, -0.9880760908126831, -0.8395513892173767, -1.0104817152023315, -0.8769848942756653, 0.18801341950893402, 0.018217336386442184, 0.1617676466703415, -0.37628015875816345, -0.146292045712471, -0.09628844261169434, -0.9353020787239075, -0.924078106880188, -0.6595888733863831, -0.9638438820838928, 0.9590887427330017, 0.44707274436950684, 0.4537378251552582, -0.13357257843017578, -0.4729936420917511, -0.49452927708625793, -0.4741637110710144, -0.4694153964519501, -0.18912406265735626, -0.22372229397296906, 0.09719046950340271, -0.19276905059814453, 0.6251004934310913, -0.513495147228241, -1.4311082363128662, 0.19555386900901794, -1.5183370113372803, -0.12524999678134918, 0.613065779209137, 0.056825991719961166, 1.0512936115264893, 0.5718832015991211, 0.867885172367096, 0.4991522431373596, 0.1431736946105957, -0.38666120171546936, -0.21155959367752075, -0.8183531165122986, -0.7983079552650452, -0.40501290559768677, -1.2801830768585205, -1.2636003494262695, -1.5111050605773926, -1.1432301998138428, -0.2650022506713867, -1.040693998336792, -1.0637929439544678, -1.1744804382324219, -1.0657607316970825, -0.9706939458847046, 0.21253493428230286, -1.9866389036178589, -0.7505611181259155, -0.11005920171737671, -0.15043169260025024, -0.8937650322914124, -1.6259801387786865, -0.8525163531303406, 0.5966652035713196, 0.22246849536895752, -0.386193186044693, -0.4631563723087311, 0.34177589416503906, 0.30634188652038574, -1.4989724159240723, -1.6237269639968872, -0.2550320029258728, 0.37604886293411255, -0.7662441730499268, -0.2241850644350052, 0.03856484219431877, -0.4956161677837372, -1.053546667098999, -0.700538694858551, 0.421164870262146, 0.4794071316719055, 0.20481079816818237, 0.1622103750705719, 0.3019469976425171, 0.14643871784210205, -1.18522047996521, -1.059079885482788, -1.3670612573623657, -1.28865647315979, -1.1892873048782349, 0.21753636002540588, 0.5344824194908142, 0.11271175742149353, 0.18377557396888733, 0.11834836006164551, -0.3595978021621704, 0.41072335839271545, -0.581342875957489, -0.3662106990814209, -1.443558931350708, -0.7009652256965637, -0.9914547801017761, -1.0343014001846313, -1.0540930032730103, -1.19636869430542, -0.3146726191043854, -0.16814863681793213, -0.5158613324165344, -0.659593403339386, -0.5312807559967041, -0.927243709564209, -1.8301843404769897, -1.9261921644210815, 0.028061378747224808, -2.2275514602661133, -1.9537895917892456, -2.058483123779297, -1.938054084777832, -0.793247401714325, -0.15268151462078094, -0.9437988996505737, -0.6771604418754578, 0.29785069823265076, -0.0628197193145752, -0.3520662784576416, -0.08784747123718262, -0.4672263264656067, -1.6571167707443237, -1.4372940063476562, -0.5224507451057434], 'eval_runtime': 141.2675, 'eval_samples_per_second': 4.644, 'eval_steps_per_second': 1.161, 'epoch': 40.0}

# import numpy as np

# # normalize test_scores from 0-1
# # scores = metrics['test_scores']
# scores = metrics_2['eval_scores']
# scores = np.array(scores)
# scores = (scores - np.min(scores)) / (np.max(scores) - np.min(scores))

# # get average of normalized scores
# print(np.mean(scores))

#---------------------------------------------------------------------

# Remember, to run visually, you can use: tensorboard --logdir ./results/runs

# Read each file that ends with -metrics.txt from /results folder
# and calculate the average of the normalized scores
import os
import glob
import numpy as np

path = './results'
files = glob.glob(os.path.join(path, '*-metrics.txt'))
# save as dictionary - the prefix of each metrics file should be the key
# example filename: ep_5_lr_0.0002_wd_0.1-metrics.txt
metrics_scores = {}
for file in files:
    key = file.split('\\')[-1]
    with open(file, 'r') as f:
        # convert file to json format
        curr_metrics = eval(f.read())
        # normalize test_scores from 0-1
        if('eval_scores' in curr_metrics): 
            scores = curr_metrics['eval_scores']
            loss = curr_metrics['eval_loss']
        else: 
            scores = curr_metrics['test_scores']
            loss = curr_metrics['test_loss']
        scores = np.array(scores)
        normalized_scores = (scores - np.min(scores)) / (np.max(scores) - np.min(scores))
        # get average of normalized scores and loss as dict
        metrics_scores[key] = {'average_scores': np.mean(scores), 'normalized_scores': np.mean(normalized_scores), 'loss': loss}

# now write metrics_scores to an easy to read file
# one line per key, with the average score, normalized score and loss
with open('hyperparameter_analysis.txt', 'w') as f:
    for key, value in metrics_scores.items():
        f.write('%s:%s\n' % (key, value))

print(metrics_scores)


